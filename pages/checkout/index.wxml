<!--pages/checkout/index.wxml-->
<view class="checkout-container">
  <!-- é…é€æ–¹å¼é€‰æ‹© -->
  <view class="delivery-section">
    <view class="section-title">é…é€æ–¹å¼</view>
    <view class="delivery-options">
      <view 
        class="delivery-option {{deliveryType === 1 ? 'active' : ''}}"
        bindtap="changeDeliveryType"
        data-type="1"
      >
        <view class="option-icon">ğŸšš</view>
        <view class="option-info">
          <text class="option-name">é€è´§ä¸Šé—¨</text>
          <text class="option-desc">å…è¿è´¹</text>
        </view>
        <view class="option-check" wx:if="{{deliveryType === 1}}">âœ“</view>
      </view>
      
      <view 
        class="delivery-option {{deliveryType === 0 ? 'active' : ''}}"
        bindtap="changeDeliveryType"
        data-type="0"
      >
        <view class="option-icon">ğŸª</view>
        <view class="option-info">
          <text class="option-name">åˆ°åº—è‡ªæ</text>
          <text class="option-desc">æ— éœ€å¡«å†™åœ°å€</text>
        </view>
        <view class="option-check" wx:if="{{deliveryType === 0}}">âœ“</view>
      </view>
    </view>
  </view>

  <!-- æ”¶è´§åœ°å€ï¼ˆé€è´§æ—¶æ˜¾ç¤ºï¼‰ -->
  <view class="address-section" wx:if="{{deliveryType === 1}}" bindtap="selectAddress">
    <view wx:if="{{!selectedAddress}}" class="no-address">
      <view class="address-icon">ğŸ“</view>
      <text class="no-address-text">è¯·é€‰æ‹©æ”¶è´§åœ°å€</text>
      <text class="arrow">></text>
    </view>
    
    <view wx:else class="address-info">
      <view class="address-header">
        <view class="address-icon">ğŸ“</view>
        <view class="user-info">
          <text class="user-name">{{selectedAddress.name}}</text>
          <text class="user-phone">{{selectedAddress.phone}}</text>
        </view>
        <text class="arrow">></text>
      </view>
      <view class="address-detail">
        <text class="address-text">{{selectedAddress.address}}</text>
      </view>
    </view>
  </view>
  
  <!-- è‡ªææç¤º -->
  <view class="pickup-tip" wx:if="{{deliveryType === 0}}">
    <view class="tip-icon">â„¹ï¸</view>
    <view class="tip-content">
      <text class="tip-title">è‡ªæåœ°å€</text>
      <text class="tip-address">ä¹¦åº—åœ°å€ï¼šåŒ—äº¬å¸‚æœé˜³åŒºå»ºå›½è·¯88å·SOHOç°ä»£åŸAåº§1å±‚</text>
      <text class="tip-time">è¥ä¸šæ—¶é—´ï¼š9:00-21:00</text>
    </view>
  </view>

  <!-- å•†å“åˆ—è¡¨ -->
  <view class="goods-section">
    <view class="section-header">
      <text class="section-title">å•†å“æ¸…å•</text>
      <text class="goods-count">å…±{{totalCount}}ä»¶</text>
    </view>
    
    <view class="goods-list">
      <view 
        class="goods-item"
        wx:for="{{selectedItems}}" 
        wx:key="id"
      >
        <view class="goods-image">
          <image src="{{item.imageUrl}}" mode="aspectFit"></image>
        </view>
        
        <view class="goods-info">
          <view class="goods-name">{{item.bookName}}</view>
          <view class="goods-price-qty">
            <text class="goods-price">Â¥{{item.price / 100}}</text>
            <text class="goods-qty">Ã—{{item.quantity}}</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- è®¢å•å¤‡æ³¨ -->
  <view class="remark-section">
    <view class="section-title">è®¢å•å¤‡æ³¨</view>
    <textarea 
      class="remark-input"
      placeholder="é€‰å¡«ï¼Œè¯·è¾“å…¥è®¢å•å¤‡æ³¨"
      value="{{remark}}"
      bindinput="onRemarkInput"
      maxlength="200"
    />
  </view>

  <!-- è´¹ç”¨æ˜ç»† -->
  <view class="cost-section">
    <view class="cost-item">
      <text class="cost-label">å•†å“æ€»ä»·</text>
      <text class="cost-value">Â¥{{totalAmount / 100}}</text>
    </view>
    <view class="cost-item">
      <text class="cost-label">è¿è´¹</text>
      <text class="cost-value free">å…è´¹</text>
    </view>
    <view class="cost-divider"></view>
    <view class="cost-item total">
      <text class="cost-label">å®ä»˜æ¬¾</text>
      <text class="cost-value">Â¥{{totalAmount / 100}}</text>
    </view>
  </view>

  <!-- åº•éƒ¨æäº¤æ  -->
  <view class="submit-bar">
    <view class="total-info">
      <text class="total-text">åˆè®¡: </text>
      <text class="total-amount">Â¥{{totalAmount / 100}}</text>
    </view>
    
    <button 
      class="submit-btn {{submitting ? 'submitting' : ''}}"
      bindtap="submitOrder"
      disabled="{{submitting}}"
    >
      {{submitting ? 'æäº¤ä¸­...' : 'æäº¤è®¢å•'}}
    </button>
  </view>
</view>
