<!--pages/login/index.wxml-->
<view class="login-container">
  <!-- 顶部装饰 -->
  <view class="login-header">
    <image class="logo" src="/assets/imgs/mine/morentouxiang.png" mode="aspectFit"></image>
    <text class="title">欢迎登录</text>
    <text class="subtitle">选择您的头像和昵称，为您提供更好的服务</text>
  </view>

  <!-- 用户信息表单 -->
  <form bindsubmit="handleLogin">
    <view class="form-container">
      
      <!-- 头像选择 -->
      <view class="form-item">
        <text class="label">选择头像</text>
        <button 
          class="avatar-picker" 
          open-type="chooseAvatar" 
          bindchooseavatar="onChooseAvatar">
          <image 
            class="avatar-image" 
            src="{{avatarUrl || '/assets/imgs/mine/morentouxiang.png'}}" 
            mode="aspectFill">
          </image>
          <view class="avatar-tip" wx:if="{{!avatarUrl}}">
            <text class="tip-icon">📷</text>
            <text class="tip-text">点击选择头像</text>
          </view>
          <view class="avatar-mask" wx:if="{{avatarUrl}}">
            <text class="change-text">更换</text>
          </view>
        </button>
      </view>

      <!-- 昵称输入 -->
      <view class="form-item">
        <text class="label">输入昵称</text>
        <view class="nickname-input-wrapper">
          <input 
            class="nickname-input" 
            type="nickname" 
            name="nickname"
            value="{{nickName}}"
            placeholder="请输入昵称"
            placeholder-class="placeholder"
            bindinput="onNicknameInput"
            bindblur="onNicknameBlur"
            maxlength="20"
          />
          <view class="input-count">{{nickName.length}}/20</view>
        </view>
      </view>

      <!-- 用户信息预览 -->
      <view class="user-preview" wx:if="{{avatarUrl && nickName}}">
        <view class="preview-label">
          <text class="icon">✓</text>
          <text>预览</text>
        </view>
        <view class="preview-card">
          <image class="preview-avatar" src="{{avatarUrl}}" mode="aspectFill"></image>
          <text class="preview-nickname">{{nickName}}</text>
        </view>
      </view>

      <!-- 登录按钮 -->
      <button 
        class="login-btn {{avatarUrl && nickName ? 'active' : 'disabled'}}" 
        form-type="submit"
        disabled="{{isLoading || !avatarUrl || !nickName}}">
        <text wx:if="{{!isLoading}}">登录</text>
        <text wx:else>登录中...</text>
      </button>

      <!-- 取消按钮 -->
      <button class="cancel-btn" bindtap="handleCancel" type="button">
        <text>取消</text>
      </button>
    </view>
  </form>

  <!-- 说明文字 -->
  <view class="tips">
    <text class="tip-text">· 我们不会获取您的手机号等敏感信息</text>
    <text class="tip-text">· 您的信息仅用于提供个性化服务</text>
    <text class="tip-text">· 登录即代表您同意我们的用户协议</text>
  </view>
</view>
